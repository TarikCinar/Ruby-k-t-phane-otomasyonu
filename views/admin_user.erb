<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-Language" content="en">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no">
  <meta name="description" content="ArchitectUI HTML Bootstrap 4 Dashboard Template">

  <meta name="msapplication-tap-highlight" content="no">

  <link href="/css/main.d810cf0ae7f39f28f336.css" rel="stylesheet"></head>

<body>
<div class="app-container app-theme-white body-tabs-shadow fixed-header fixed-sidebar">
  <div class="app-header header-shadow">
    <div class="app-header__logo">
      <div class="logo-src"></div>
      <div class="header__pane ml-auto">
        <div>
          <button type="button" class="hamburger close-sidebar-btn hamburger--elastic" data-class="closed-sidebar">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
          </button>
        </div>
      </div>
    </div>
    <div class="app-header__mobile-menu">
      <div>
        <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
                        <span class="hamburger-box">
                            <span class="hamburger-inner"></span>
                        </span>
        </button>
      </div>
    </div>
    <div class="app-header__menu">
                <span>
                    <button type="button" class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
                        <span class="btn-icon-wrapper">
                            <i class="fa fa-ellipsis-v fa-w-6"></i>
                        </span>
                    </button>
                </span>
    </div>
    <div class="app-header__content">
          <input id="search_filter" class="form-control" type="text" placeholder="Kullanıcı ara" aria-label="Search" onkeyup="filter()" style="width: 910px">
    <div class="app-header-right">
      <div class="header-dots"></div>
      <div class="header-btn-lg pr-0" style="margin-right:50px ">
        <div class="widget-content p-0">
          <div class="widget-content-wrapper">
            <div class="widget-content-left">
              <div class="btn-group">
                <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="p-0 btn">
                  <img width="42" class="rounded-circle" src="/profil_photo/<%=@user[0][6] %>" alt="">
                  <i class="fa fa-angle-down ml-2 opacity-8"></i>
                </a>
                <div tabindex="-1" role="menu" aria-hidden="true" class="rm-pointers dropdown-menu-lg dropdown-menu dropdown-menu-right">
                  <div class="dropdown-menu-header">
                    <div class="dropdown-menu-header-inner bg-info">
                      <div class="menu-header-image opacity-2" style="background-image: url('assets/images/dropdown-header/city3.jpg');"></div>
                      <div class="menu-header-content text-left">
                        <div class="widget-content p-0">
                          <div class="widget-content-wrapper">
                            <div class="widget-content-left mr-3">
                              <img width="42" class="rounded-circle" src="/profil_photo/<%=@user[0][6] %>" alt="">
                            </div>
                            <div class="widget-content-left">
                              <div class="widget-heading"><%=@user[0][2] %><%=@user[0][3] %></div>
                              <div class="widget-subheading opacity-8">Admin</div>
                            </div>
                            <div class="widget-content-right mr-2">
                              <button class="btn-pill btn-shadow btn-shine btn btn-focus" onclick="location.href='/logout'">Çıkış</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="widget-content-left  ml-3 header-user-info">
              <div class="widget-heading"><%=@user[0][2] %><%=@user[0][3] %></div>
              <div class="widget-subheading opacity-8">Admin</div>
            </div>
          </div>
        </div>
      </div>
        </div>
  </div>
  </div>        <div class="ui-theme-settings">
    <i class="fa fa-cog fa-w-16 fa-spin fa-2x"></i>
  </button>
</div>
  <div class="app-main">
  <div class="app-sidebar sidebar-shadow">
    <div class="app-header__logo">
      <div class="logo-src"></div>
      <div class="header__pane ml-auto">
        <div>
          <button type="button" class="hamburger close-sidebar-btn hamburger--elastic" data-class="closed-sidebar">
                                <span class="hamburger-box">
                                    <span class="hamburger-inner"></span>
                                </span>
          </button>
        </div>
      </div>
    </div>
    <div class="app-header__mobile-menu">
      <div>
        <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
        </button>
      </div>
    </div>
    <div class="app-header__menu">
                    <span>
                        <button type="button" class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
                            <span class="btn-icon-wrapper">
                                <i class="fa fa-ellipsis-v fa-w-6"></i>
                            </span>
                        </button>
                    </span>
    </div>    <div class="scrollbar-sidebar">
    <div class="app-sidebar__inner">
      <ul class="vertical-nav-menu">
        <li class="app-sidebar__heading">Menu</li>
        <li class="mm-active">
          <a href="#">
            <i class="metismenu-icon pe-7s-user"></i>Kullanıcılar
            <i class="metismenu-state-icon pe-7s-angle-down caret-left"></i>
          </a>
          <ul class="mm-show">
            <li>
              <a href="/admin/user" class="mm-active">
                <i class="metismenu-icon"></i>Tüm kullanıcılar
              </a>
            </li>
            <li>
              <a href="/admin/kullanici-ekle">
                <i class="metismenu-icon"></i>Kullanıcı Ekle
              </a>
            </li>
          </ul>
        </li>
        <li class="mm-active">
          <a href="#">
            <i class="metismenu-icon pe-7s-bookmarks"></i>Kitaplar
            <i class="metismenu-state-icon pe-7s-angle-down caret-left"></i>
          </a>
          <ul>
            <li>
              <a href="/admin/alinan-kitaplar">
                <i class="metismenu-icon"></i>Alınan Kitaplar
              </a>
            </li>
            <li>
              <a href="/admin/tum-kitaplar">
                <i class="metismenu-icon"></i>Tüm kitaplar
              </a>
            </li>

            <li>
              <a href="/admin/kitap-ekle">
                <i class="metismenu-icon"></i>Kitap Ekle
              </a>
            </li>
          </ul>
        </li>

        <li class="mm-active">
          <a href="#">
            <i class="metismenu-icon pe-7s-plugin"></i>Dergiler
            <i class="metismenu-state-icon pe-7s-angle-down caret-left"></i>
          </a>
          <ul>
            <li>
              <a href="/admin/alinan-dergiler">
                <i class="metismenu-icon"></i>Alınan Dergiler
              </a>
            </li>
            <li>
              <a href="/admin/tum-degiler">
                <i class="metismenu-icon"></i>Tum Dergiler
              </a>
            </li>
            <li>
              <a href="/admin/dergi-ekle" >
                <i class="metismenu-icon"></i>Dergi Ekle
              </a>
            </li>
          </ul>
        </li>
        <li class="mm-active">
          <a href="#">
            <i class="metismenu-icon pe-7s-plugin"></i>E-Kitaplar
            <i class="metismenu-state-icon pe-7s-angle-down caret-left"></i>
          </a>
          <ul>
            <li>
              <a href="/admin/tum-e-kitaplar">
                <i class="metismenu-icon"></i>Tum E-kitaplar
              </a>
            </li>
            <li>
              <a href="/admin/e-kitap-ekle">
                <i class="metismenu-icon"></i>E-kitap Ekle
              </a>
            </li>
          </ul>
        </li>

      </ul>
    </div>
  </div>
  </div><div class="app-main__outer">
  <div class="app-main__inner p-0">
    <div class="container-fluid">
      <div class="row justify-content-md-center" style="margin-top: 50px">
        <div class="col-lg-12">
          <table class="table " style="text-align: center" id="userTable">
            <thead class="thead-dark">
            <tr >
              <th scope="col">Resim</th>
              <th scope="col">İsim</th>
              <th scope="col">Soyisim</th>
              <th scope="col">Admin durumu</th>
              <th scope="col">İşlemler</th>
            </tr>
            </thead>
            <tbody>
            <% @user_all.each { |i| %>
              <tr>
                <td>
                  <img class="img-circle" src="/profil_photo/<%= i[6] %>" alt="Card image cap" style="width: 100px;height: 100px;border-radius: 50px" >
                </td>
                <td style="padding-top:20px"><span style='font-family: "Poppins", Arial, sans-serif;font-weight: bold;font-size: 20px'><%= i[2] %></span></td>
                <td style="padding-top: 20px"><span style='font-family: "Poppins", Arial, sans-serif;font-weight: bold;font-size: 20px'><%= i[3]  %></span></td>
                <td style="padding-top: 20px"><span style='font-family: "Poppins", Arial, sans-serif;font-weight: bold;font-size: 20px'><%= i[1] %></span></td>
                <td style="padding-top: 20px;">
                    <div class="row justify-content-md-center">
                      <button onclick="duzenle(<%=i[0] %>)" type="button" class="btn btn-primary">Düzenle</button>
                      <button onclick="uyari(<%=i[0] %>)" type="button" class="btn btn-danger" style="margin-left: 10px">Sil</button>
                    </div>
                </td>
              </tr>
            <% } %>
            </tbody>
          </table>


          <div id="myModal" class="modal" style="margin-left: 100px;">
            <div class="row justify-content-md-center" >
              <div class="col-lg-6">
                <div class="modal-content">
                  <div class="row  justify-content-md-end" style="padding-right: 20px">
                    <button onclick="spanClose()" type="button" class="close" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div><br>
                  <div class="row justify-content-md-center">
                    <h3 style="font-weight: 600">Bu kullanıcı kaldırılsın mı?</h3>
                  </div><br><br>
                  <div class="row justify-content-md-center">
                    <input name="input_id" style="display: none">
                    <button onclick="kapat()" type="button" class="btn btn-primary" style="width: 150px;height: 40px">İptal</button>
                    <button onclick="kaldir()" type="button" class="btn btn-danger" style="width: 150px;height: 40px;margin-left: 30px">Kaldır</button>
                    <button id="gonder" type="submit" style="display: none"></button>
                  </div>
                </div>
              </div>
            </div>
          </div>


          <div id="DuzenleModal" class="modal" style="margin-left: 100px">
            <div class="row justify-content-md-center" >
              <div class="col-lg-7">
                <div class="modal-content">
                  <div class="row  justify-content-md-end" style="padding-right: 20px">
                    <button onclick="duzenleKapat()" type="button" class="close" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div><br>
                  <div class="row justify-content-md-center">
                    <div class="col-lg-10">
                      <div class="form-group">
                        <label for="largeInput" style="font-weight: bold">İsim</label>
                        <input type="text" class="form-control form-control" id="isim" placeholder="isim" >
                      </div>

                      <div class="form-group">
                        <label for="largeInput" style="font-weight: bold">Soyisim</label>
                        <input type="text" class="form-control form-control" id="soyisim" placeholder="soyisim" name="soyisim" >
                      </div>

                      <div class="form-group">
                        <label for="largeInput" style="font-weight: bold">email</label>
                        <input type="email" class="form-control form-control" id="email" placeholder="email" name="email" >
                      </div>

                      <div class="form-group">
                        <label for="largeInput" style="font-weight: bold">Şifre</label>
                        <input type="text" class="form-control form-control" id="password" placeholder="şifre" name="password" >
                      </div>

                      <div class="form-group">
                        <label for="largeInput" style="font-weight: bold">Admin durumu</label><br>
                          <input type="checkbox" id="admin" placeholder="admin" style="width: 25px" name="admin"  >
                      </div><br>
                    </div>
                  </div><br>
                  <div class="row justify-content-md-center">
                    <input name="input_id" style="display: none">
                    <button onclick="duzenleKapat()" type="button" class="btn btn-primary" style="width: 150px;height: 40px">İptal</button>
                    <button onclick="duzenlePost()" type="button" class="btn btn-danger" style="width: 150px;height: 40px;margin-left: 30px">Düzenle</button>
                    <button id="gonder" type="submit" style="display: none"></button>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
</div>
<div class="app-drawer-overlay d-none animated fadeIn"></div>
  <script type="text/javascript" src="/assets/scripts/main.d810cf0ae7f39f28f336.js"></script>
</div>
</body>
<style>
  body {font-family: Arial, Helvetica, sans-serif;}

  /* The Modal (background) */
  .modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    padding-top: 100px; /* Location of the box */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
  }

  /* Modal Content */
  .modal-content {
    background-color: #fefefe;
    margin: auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
  }

  /* The Close Button */
  .close {
    color: #aaaaaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }

  .close:hover,
  .close:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
  }
</style>

<script language="JavaScript">
    // Get the modal
    var modal = document.getElementById("myModal");
    var DuzenleModal = document.getElementById("DuzenleModal");

    var iptal=document.getElementById("iptal");

    iptal.onclick=function(){
        modal.style.display = "none";
    };
    // When the user clicks on <span> (x), close the modal
    function spanClose() {
        modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    };
    var user_id;
    function kapat() {
        modal.style.display = "none";
    }
    function uyari(id) {
        user_id=id;
        modal.style.display = "block";
    }
    function duzenleKapat() {
      DuzenleModal.style.display="none"
    }
    function duzenle(id) {
        user_id=id;
        DuzenleModal.style.display="block";

    }
    function kaldir() {
            method = "post";
            var form = document.createElement("form");
            form._submit_function_ = form.submit;

            form.setAttribute("method", method);
            form.setAttribute("action", "/admin/user/user-remove");
                var hiddenField = document.createElement("input");
                hiddenField.setAttribute("type", "hidden");
                hiddenField.setAttribute("name", "id");
                hiddenField.setAttribute("value", user_id);
                form.appendChild(hiddenField);
            document.body.appendChild(form);
            form._submit_function_();

    }
    function duzenlePost() {
        isim=document.getElementById("isim").value;
        soyisim=document.getElementById("soyisim").value;
        email=document.getElementById("email").value;
        password=document.getElementById("password").value;
        admin=document.getElementById("admin").checked;

        post_to_url("/admin/user/edit",
              {"id":user_id,
                "isim": isim,
                "soyisim":soyisim,
                "email":email,
                "password":password,
                "admin":admin} ); //Works!

    }

    function post_to_url(path, params, method) {
        method = method || "post";

        var form = document.createElement("form");

        //Move the submit function to another variable
        //so that it doesn't get overwritten.
        form._submit_function_ = form.submit;

        form.setAttribute("method", method);
        form.setAttribute("action", path);

        for(var key in params) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", params[key]);

            form.appendChild(hiddenField);
        }
        document.body.appendChild(form);
        form._submit_function_(); //Call the renamed function.
    }
    function filter() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("search_filter");
        filter = input.value.toUpperCase();
        table = document.getElementById("userTable");
        tr = table.getElementsByTagName("tr");
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[1];
            if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }

</script>

</html>